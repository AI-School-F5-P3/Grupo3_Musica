<!-- templates/nueva_inscripcion.html -->
{% extends "base.html" %}

{% block content %}
<h1>Nueva Inscripción</h1>
<form method="POST" id="inscripcionForm">
    <div class="form-group">
        <label for="alumno_id">Alumno:</label>
        <select class="form-control" id="alumno_id" name="alumno_id" onchange="calcularPrecio()">
            {% for alumno in alumnos %}
            <option value="{{ alumno[0] }}">{{ alumno[1] }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="clase_id">Clase:</label>
        <select class="form-control" id="clase_id" name="clase_id" onchange="calcularPrecio()">
            {% for clase in clases %}
            <option value="{{ clase[0] }}">{{ clase[1] }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="nivel_id">Nivel:</label>
        <select class="form-control" id="nivel_id" name="nivel_id" onchange="calcularPrecio()">
            {% for nivel in niveles %}
            <option value="{{ nivel[0] }}">{{ nivel[1] }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="precio">Precio Calculado:</label>
        <input type="text" class="form-control" id="precio" name="precio" readonly>
    </div>
    <button type="submit" class="btn btn-primary">Añadir Inscripción</button>
</form>

<script>
    function calcularPrecio() {
        var alumnoId = document.getElementById('alumno_id').value;
        var claseId = document.getElementById('clase_id').value;
        var nivelId = document.getElementById('nivel_id').value;

        // Aquí puedes hacer una solicitud AJAX para calcular el precio en el servidor
        fetch('/calcular_precio', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ alumno_id: alumnoId, clase_id: claseId, nivel_id: nivelId }),
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('precio').value = data.precio;
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    }
</script>
{% endblock %}
